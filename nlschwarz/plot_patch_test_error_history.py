import numpy as np
import matplotlib.pyplot as plt

# en_er_pm_01 = [0.2005185691088025, 0.1961012494405857, 0.15741580342517897, 0.1279456440507961, 0.1047520705980721, 0.08620718415104767, 0.07119877505808218, 0.05894517119146216, 0.04887898276813666, 0.040574938888389214, 0.0337052277075804, 0.028011447520516406, 0.023286472632142723, 0.01936227765234248, 0.016101418197240203, 0.013390827853862032, 0.011137141452496873, 0.009263068251705406, 0.0077045183961761445, 0.0064082905142155535, 0.005330190473403493, 0.004433489434446439, 0.0036876536408604653, 0.003067294549696331, 0.002551299164502861, 0.0021221085946264554, 0.0017651190103027009, 0.0014681839228294217, 0.0012212004849803267, 0.0010157655396619513, 0.0008448896095903023, 0.0007027590437078267, 0.0005845381953309838, 0.0004862048904421981, 0.0004044135798059627, 0.00033638151239503235, 0.00027979406053924027, 0.00023272597004772715, 0.00019357585918505766, 0.00016101173581558985, 0.00013392568001112607, 0.00011139615006270315, 9.265662937531277e-05, 7.706954745719593e-05, 6.410458850700755e-05, 5.33206481736907e-05, 4.435082708274804e-05, 3.688994633647771e-05, 3.0684165840869425e-05, 2.5522347558182135e-05, 2.12288716913782e-05, 1.765766248041198e-05, 1.4687216735950928e-05, 1.2216471895557586e-05, 1.0161365968382814e-05, 8.45197846793111e-06, 7.030151442155271e-06, 5.847510009249074e-06, 4.863817424373284e-06, 4.045605716093982e-06, 3.3650370089871512e-06, 2.798956434177568e-06, 2.328104270496187e-06, 1.93646084073314e-06, 1.6107012608027221e-06, 1.3397424185575984e-06, 1.1143654198071778e-06, 9.269021162752713e-07, 7.709747706365672e-07, 6.41278143966484e-07, 5.333996908989136e-07, 4.4366904962410186e-07, 3.6903307929440384e-07, 3.0695282350410817e-07, 2.553159171063941e-07, 2.1236559703873816e-07, 1.766406251146051e-07, 1.4692534326544808e-07, 1.222089453044367e-07, 1.0165043679461458e-07, 8.455034858864575e-08, 7.032690465357998e-08, 5.849632839375475e-08, 4.8655821919995804e-08, 4.047069828471735e-08, 3.3662589202524466e-08, 2.7999464925227655e-08, 2.3289630216910457e-08, 1.9371700254818824e-08, 1.6112933856817066e-08, 1.3402334531544156e-08, 1.1147673855936504e-08, 9.2722330148573e-09, 7.712646965892128e-09, 6.415100765130213e-09, 5.33600222480162e-09, 4.438159247348241e-09, 3.6916416163244036e-09, 3.070746635462942e-09, 2.554157390242102e-09, 2.124480802665519e-09, 1.7669259315004211e-09, 1.4695523518862961e-09, 1.2226042747882114e-09]
res_er_pm_01 = [0.20877001700443049, 0.1766839683028031, 0.14392564532486557, 0.1181164897137785, 0.09739553393017122, 0.0805669757192712, 0.06678669997322204, 0.05543868358887046, 0.046058482042207256, 0.03828590857326148, 0.03183538275447876, 0.02647678511563923, 0.02202258464935071, 0.018318792569993077, 0.015238331230167677, 0.01267599447159594, 0.010544506873774626, 0.008771376969196257, 0.00729634726991766, 0.006069307342926534, 0.0050485747357588715, 0.004199473035475919, 0.0034931526566285964, 0.0029056113832648103, 0.0024168800720479507, 0.00201034531085693, 0.0016721858457984648, 0.0013909036083093308, 0.0011569334500280176, 0.000962318379543892, 0.0008004393172107595, 0.0006657902273550136, 0.0005537910174021719, 0.0004606318687084683, 0.0003831437246187516, 0.00031869054398781725, 0.0002650796664287209, 0.00022048724588551535, 0.0001833962214799918, 0.00015254471866269753, 0.00012688312696342924, 0.00010553839669059632, 8.778434004758216e-05, 7.3016927517503e-05, 6.073373903934879e-05, 5.051687188662952e-05, 4.20187235392487e-05, 3.4950165631398485e-05, 2.907070764800504e-05, 2.418031504576145e-05, 2.011260363073532e-05, 1.6729178915388827e-05, 1.3914927535341028e-05, 1.1574100992096711e-05, 9.627057791393303e-06, 8.00755419110654e-06, 6.660490176944634e-06, 5.540034815455083e-06, 4.6080671201744135e-06, 3.8328788517112856e-06, 3.1880959810873987e-06, 2.651781194860544e-06, 2.2056874829227924e-06, 1.8346375195115552e-06, 1.5260071315820266e-06, 1.26929586071512e-06, 1.0557695988995146e-06, 8.781635985560614e-07, 7.304352515515536e-07, 6.075583833635744e-07, 5.053523862035928e-07, 4.203398938420356e-07, 3.4962853130977107e-07, 2.9081256390772617e-07, 2.418908745495066e-07, 2.0119897439879006e-07, 1.673524388833883e-07, 1.3919968318454547e-07, 1.1578297456543975e-07, 9.63054661332378e-08, 8.01045540885511e-08, 6.662905640075029e-08, 5.542044424258247e-08, 4.609738135814923e-08, 3.834268498819052e-08, 3.189250270329208e-08, 2.6527422015371824e-08, 2.2064959410113408e-08, 1.8353082775961108e-08, 1.52656189475413e-08, 1.2697572729850116e-08, 1.0561532039154874e-08, 8.784810631020987e-09, 7.3070647560303945e-09, 6.077825867063916e-09, 5.055394741535308e-09, 4.204942793384969e-09, 3.497629469453174e-09, 2.9092489118056012e-09, 2.4198268815182318e-09, 2.0127402378833073e-09, 1.6741377535611431e-09, 1.3925396941206084e-09, 1.158280110799081e-09, 9.634381999551755e-10]

# en_er_pm_005 = [0.1828478452247629, 0.18855099488183039, 0.15202217370785834, 0.12430169114065544, 0.1024147952765129, 0.08483677698786361, 0.07053539305440538, 0.05879051545315715, 0.049082091689121, 0.04102139978541562, 0.0343089263976761, 0.028708194666735985, 0.024029040789022196, 0.020116518086510094, 0.016843216105988594, 0.014103714945717105, 0.011810426981333819, 0.009890380120125972, 0.008282668897260592, 0.006936398881228823, 0.0058090082457881755, 0.004864885570562249, 0.00407422504820454, 0.00341207468900993, 0.0028575429875975066, 0.0023931365778793023, 0.0020042066483520063, 0.0016784859290812552, 0.0014057012603341033, 0.001177249301854682, 0.00098592504288839, 0.0008256944874406723, 0.0006915043098074207, 0.0005791224603172939, 0.00048500468404834155, 0.0004061827366668652, 0.0003401707686396371, 0.0002848869283116649, 0.00023858770222294983, 0.00019981292889051594, 0.0001673397506340348, 0.00014014404504799412, 0.0001173681285197086, 9.829370627934832e-05, 8.231921881940629e-05, 6.89408717629053e-05, 5.7736745650617915e-05, 4.835349058456603e-05, 4.0495182492596804e-05, 3.391399018589112e-05, 2.840235932011711e-05, 2.378646751160146e-05, 1.9920740571777363e-05, 1.6683263492824015e-05, 1.3971934153098068e-05, 1.17012449928522e-05, 9.79958311943958e-06, 8.206975352844291e-06, 6.8731946753064726e-06, 5.756177748191642e-06, 4.8206957171128865e-06, 4.037246194518834e-06, 3.381121530879944e-06, 2.8316286769360637e-06, 2.3714382539885044e-06, 1.9860371846788142e-06, 1.6632705549950339e-06, 1.3929593469734073e-06, 1.1665784155818809e-06, 9.76988568006155e-07, 8.18210381438999e-07, 6.852366621526791e-07, 5.738732634859808e-07, 4.806085933185761e-07, 4.0250124009308983e-07, 3.370873798385726e-07, 2.8230463461661384e-07, 2.3642537452255742e-07, 1.9800167206953881e-07, 1.6582288511690547e-07, 1.3887369925745563e-07, 1.163046647346075e-07, 9.740252794835661e-08, 8.157290488168112e-08, 6.831635510687984e-08, 5.7213083285309735e-08, 4.791501647428641e-08, 4.0127907352352445e-08, 3.360687090640883e-08, 2.8144729127249652e-08, 2.3570742162435317e-08, 1.9740167545286758e-08, 1.6531803841091367e-08, 1.3845319355793202e-08, 1.159498507923089e-08, 9.710669466061854e-09, 8.132812500358828e-09, 6.810817191406511e-09, 5.703770384275866e-09, 4.777179121217078e-09, 4.000714307173311e-09, 3.3503060106887366e-09, 2.806323256467794e-09, 2.3497970314157387e-09, 1.9682859346982472e-09]
res_er_pm_005 = [0.12166352114425527, 0.10197882004538407, 0.083341538107646, 0.06869476980536875, 0.05692602625087516, 0.047343140692092625, 0.03946778522451578, 0.032954610083019364, 0.027544944518243835, 0.02303901259197858, 0.019278768564625022, 0.016136926492987425, 0.01350966042185735, 0.011311531710295074, 0.009471812207198383, 0.007931717814902975, 0.006642262565008427, 0.005562554695283794, 0.004658420470791671, 0.0039012793428600157, 0.0032672169858191814, 0.002736217182838061, 0.0022915230052588343, 0.001919104236844345, 0.0016072126696249772, 0.00134601038839456, 0.0011272588541602988, 0.000944058728178999, 0.0007906320936514218, 0.0006621401320751001, 0.0005545304640093999, 0.0004644093177405211, 0.00038893448258376685, 0.00032572566439518857, 0.0002727894127828186, 0.00022845625035830072, 0.00019132802048707517, 0.00016023379250838845, 0.0001341929330217015, 0.00011238417917673325, 9.411973815342174e-05, 7.882359567553745e-05, 6.601335013263292e-05, 5.528499879439558e-05, 4.630019658081819e-05, 3.877558559806252e-05, 3.247385861589879e-05, 2.7196275095420007e-05, 2.2776393393595985e-05, 1.9074821608424765e-05, 1.597482151868806e-05, 1.3378626980754456e-05, 1.1204360513721554e-05, 9.383451283113529e-06, 7.858472410262406e-06, 6.581329959313193e-06, 5.511745973150883e-06, 4.615988539496951e-06, 3.865807731567498e-06, 3.2375447753831734e-06, 2.7113857555714377e-06, 2.2707370059011757e-06, 1.9017015972900615e-06, 1.5926410204782974e-06, 1.333808337243281e-06, 1.117040602856692e-06, 9.355014903141967e-07, 7.834657357321847e-07, 6.561385103440051e-07, 5.495042472759197e-07, 4.601999604484469e-07, 3.854092219489765e-07, 3.227732938862088e-07, 2.703168545812973e-07, 2.2638552789016114e-07, 1.895937943081292e-07, 1.5878141656087107e-07, 1.3297659928286415e-07, 1.1136547729798724e-07, 9.326660551538176e-08, 7.810911697403344e-08, 6.541499597612671e-08, 5.478381804858829e-08, 4.588048501529416e-08, 3.8424099064650785e-08, 3.217942264631356e-08, 2.6949716055752227e-08, 2.2569924911122215e-08, 1.8901931866948486e-08, 1.5829984230732782e-08, 1.325734938644709e-08, 1.1102810584528815e-08, 9.298411749715484e-09, 7.787277452780909e-09, 6.521716240402101e-09, 5.461873105970979e-09, 4.5742301980564795e-09, 3.830837681545782e-09, 3.20827039821015e-09, 2.686945119506025e-09, 2.250265241300372e-09, 1.8845581592255224e-09, 1.5783506442300815e-09, 1.321822616668387e-09, 1.107009283999092e-09, 9.270942093211585e-10]

en_er_pm_0025 = [0.18182675082221136, 0.18956538869650985, 0.15270244037903052, 0.12477318770667944, 0.10273807668658498, 0.08505287436672711, 0.0706733315779701, 0.05887141033001467, 0.049121585915544115, 0.04103120893419633, 0.03429786914250857, 0.02868291150797939, 0.023994514050894502, 0.020076458934723297, 0.0168003584637564, 0.014060041640299937, 0.011767345189860248, 0.009848858106427022, 0.00824334261693717, 0.006899655066831738, 0.0057750490083276216, 0.004833778477785548, 0.004045941704950074, 0.0033865202308557, 0.002834578517830426, 0.0023725960888463515, 0.0019859094895450908, 0.0016622460347783836, 0.001391333677918363, 0.0011645747665562146, 0.0009747730646544492, 0.0008159052030386054, 0.0006829295580528638, 0.000571626204635465, 0.00047846299877452996, 0.0004004834772288119, 0.0003352129797945577, 0.00028058023233664537, 0.00023485149937221925, 0.00019657559674418073, 0.00016453785825862574, 0.00013772161356027503, 0.00011527586204901531, 9.648829090853956e-05, 8.076270876282093e-05, 6.760007117110417e-05, 5.658266447147445e-05, 4.736086986837624e-05, 3.964203244775703e-05, 3.318120772474544e-05, 2.7773360617195498e-05, 2.3246881951576482e-05, 1.9458123117600874e-05, 1.6286855192680902e-05, 1.3632436111888263e-05, 1.1410633314538293e-05, 9.550937296330138e-06, 7.994333901926074e-06, 6.69142356862962e-06, 5.600860760696134e-06, 4.688037657355039e-06, 3.923984928429421e-06, 3.284457260736712e-06, 2.7491591187070874e-06, 2.3011034196322657e-06, 1.9260715488206434e-06, 1.6121618972169435e-06, 1.3494129967736317e-06, 1.1294869034022021e-06, 9.454039849384181e-07, 7.913230018849388e-07, 6.62353790467998e-07, 5.544038228972639e-07, 4.640476859199821e-07, 3.8841767887575486e-07, 3.251135096042471e-07, 2.7212715493834224e-07, 2.2777557601057614e-07, 1.906536701393227e-07, 1.5958011197705183e-07, 1.3357196842369635e-07, 1.1180325520618036e-07, 9.358071431505162e-08, 7.832997991886763e-08, 6.556275168454037e-08, 5.4878209850118894e-08, 4.5933293442497194e-08, 3.8447222386917396e-08, 3.2181883126505174e-08, 2.693606103534574e-08, 2.2546914170259395e-08, 1.8871209108301237e-08, 1.579579069343189e-08, 1.3222077803330207e-08, 1.1066268367745835e-08, 9.263498274944054e-09, 7.753110369076632e-09, 6.489620147741984e-09, 5.431853656575748e-09, 4.5461643734352445e-09, 3.805219905861579e-09]
res_er_pm_0025 = [0.06840174911988559, 0.05637443273571993, 0.045987858878364936, 0.03786367205206051, 0.03135059552952315, 0.026053933379731154, 0.021705145531414217, 0.01811146339226672, 0.015128862460760423, 0.01264626879230925, 0.010575904644510505, 0.008847143164294176, 0.0074024256433894865, 0.006194426498748683, 0.005183999583072191, 0.004338634034261706, 0.003631257427056856, 0.0030392862708581267, 0.0025438598405194916, 0.0021292145001505043, 0.0017821685497675188, 0.0014916957090103755, 0.0012485706836333136, 0.0010450739030225475, 0.0008747451552801197, 0.0007321778018924977, 0.000612846768020699, 0.0005129646967548639, 0.0004293616223755666, 0.0003593842934724397, 0.0003008119276997136, 0.000251785711224753, 0.00021074979408328547, 0.00017640190711729176, 0.00014765203021674533, 0.0001235877973743672, 0.00010344554211020748, 8.658606019037707e-05, 7.247432683593012e-05, 6.066251484149321e-05, 5.0775784182252595e-05, 4.250038571276452e-05, 3.557370577476739e-05, 2.9775931228797066e-05, 2.4923073396994965e-05, 2.086113070514532e-05, 1.746120037030768e-05, 1.4615387887982884e-05, 1.2233383796612228e-05, 1.0239596726038077e-05, 8.570755589028198e-06, 7.173900758505842e-06, 6.00470428200493e-06, 5.026062456753754e-06, 4.206918919683587e-06, 3.521278702215037e-06, 2.947383613834812e-06, 2.4670214327706883e-06, 2.064948341913421e-06, 1.7284047363070254e-06, 1.4467107717497953e-06, 1.21092703474817e-06, 1.0135711563206097e-06, 8.483801541933009e-07, 7.101118572552971e-07, 5.943784037325475e-07, 4.97507098863746e-07, 4.164237956143741e-07, 3.4855541001770396e-07, 2.9174812975716084e-07, 2.441992723948369e-07, 2.043998735346274e-07, 1.7108694771981923e-07, 1.4320334316615972e-07, 1.1986417548333544e-07, 1.0032878570268229e-07, 8.397728460880755e-08, 7.029069362745032e-08, 5.883478124318622e-08, 4.924586679799819e-08, 4.1219831140159214e-08, 3.450187254243111e-08, 2.887872211557569e-08, 2.4172115526458042e-08, 2.0232503850758675e-08, 1.6935057363223852e-08, 1.4174946492484039e-08, 1.1864760416803031e-08, 9.931080480595768e-09, 8.312476270054616e-09, 6.9577497278046446e-09, 5.823729585723673e-09, 4.874623192301574e-09, 4.080187099952015e-09, 3.415167940673524e-09, 2.8586071569122614e-09, 2.392680844904669e-09, 2.0027511866256197e-09, 1.6763474720730557e-09, 1.4031603052164268e-09, 1.1745129754536881e-09, 9.831164750642938e-10]


# energy
# x_values_m_01 = [i for i in range(1, (len(en_er_pm_01)) + 1)]
# plt.plot(x_values_m_01, en_er_pm_01, label='multiplicative Schwarz for h=0.1', ls='-', color='b')

# x_values_m_005 = [i for i in range(1, (len(en_er_pm_005)) + 1)]
# plt.plot(x_values_m_005, en_er_pm_005, label='multiplicative Schwarz for h=0.05', ls='--', color='r')

# x_values_m_0025 = [i for i in range(1, (len(en_er_pm_0025)) + 1)]
# plt.plot(x_values_m_0025, en_er_pm_0025, label='multiplicative Schwarz for h=0.025', ls=':', color='g')


# residual
x_values_m_01 = [i for i in range((len(res_er_pm_01)))]
plt.plot(x_values_m_01, res_er_pm_01, label='multiplicative Schwarz for h=0.1', ls='-', color='b')

x_values_m_005 = [i for i in range((len(res_er_pm_005)))]
plt.plot(x_values_m_005, res_er_pm_005, label='multiplicative Schwarz for h=0.05', ls='--', color='r')

x_values_m_0025 = [i for i in range((len(res_er_pm_0025)))]
plt.plot(x_values_m_0025, res_er_pm_0025, label='multiplicative Schwarz for h=0.025', ls=':', color='g')

ref_points = [0, 120]
error_ref = [1.0, 1E-9]

plt.plot(ref_points, error_ref, label='reference for linear convergence', ls='-', color='gray')

plt.xlabel('iteration')
# plt.ylabel('energy error')
plt.ylabel('residual error')
plt.yscale('log')
plt.legend(loc='upper right')#, bbox_to_anchor=(1.0, 1.1), framealpha=1)
# plt.savefig('patch_test_energy_error_history.pdf')
plt.savefig('patch_test_residual_error_history_with_ref.pdf')
plt.show()
